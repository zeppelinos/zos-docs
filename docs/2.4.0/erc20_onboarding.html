<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"/><meta http-equiv="X-UA-Compatible" content="IE=edge"/><title>Onboarding ERC20 tokens · ZeppelinOS</title><meta name="viewport" content="width=device-width"/><meta name="generator" content="Docusaurus"/><meta property="og:title" content="Onboarding ERC20 tokens · ZeppelinOS"/><meta property="og:type" content="website"/><meta property="og:url" content="https://docs.zeppelinos.org/index.html"/><meta property="og:description" content="## Intro"/><meta name="twitter:card" content="summary"/><link rel="shortcut icon" href="/img/favicon.png"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.css"/><link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css"/><script>
              (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
              (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
              m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
              })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

              ga('create', 'UA-102575245-1', 'auto');
              ga('send', 'pageview');
            </script><link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/><link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Lato:100,200,300,400,500,700,400italic,700italic"/><script type="text/javascript" src="https://buttons.github.io/buttons.js"></script><link rel="stylesheet" href="/css/main.css"/></head><body class="sideNavVisible doc"><div class="fixedHeaderContainer"><div class="headerWrapper wrapper"><header><a href="/"><img class="logo" src="/img/logo.svg" alt="ZeppelinOS"/></a><a href="/versions.html"><h3>2.4.0</h3></a><div class="navigationWrapper navigationSlider"><nav class="slidingNav"><ul class="nav-site nav-site-internal"><li class="siteNavGroupActive"><a href="/docs/2.4.0/start.html" target="_self">Quickstart</a></li><li class=""><a href="/docs/2.4.0/apis.html" target="_self">Reference</a></li><li class=""><a href="https://blog.zeppelinos.org" target="_self">Blog</a></li><li class=""><a href="https://forum.zeppelin.solutions" target="_self">Forum</a></li><li class=""><a href="https://github.com/zeppelinos" target="_self">GitHub</a></li><li class="navSearchWrapper reactNavSearchWrapper"><input type="text" id="search_input_react" placeholder="Search" title="Search"/></li></ul></nav></div></header></div></div><div class="navPusher"><div class="docMainWrapper wrapper"><div class="container docsNavContainer" id="docsNav"><nav class="toc"><div class="toggleNav"><section class="navWrapper wrapper"><div class="navBreadcrumb wrapper"><div class="navToggle" id="navToggler"><i></i></div><h2><i>›</i><span>GUIDES</span></h2></div><div class="navGroups"><div class="navGroup navGroupActive"><h3>OVERVIEW</h3><ul><li class="navListItem"><a class="navItem" href="/docs/2.4.0/start.html">ZeppelinOS</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/new_2.4.html">What&#x27;s new in ZeppelinOS 2.4</a></li></ul></div><div class="navGroup navGroupActive"><h3>QUICKSTART</h3><ul><li class="navListItem"><a class="navItem" href="/docs/2.4.0/first.html">Your first project</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/interacting.html">Interacting with your contracts</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/linking.html">Linking OpenZeppelin contracts</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/zepkit.html">ZepKit</a></li></ul></div><div class="navGroup navGroupActive"><h3>GUIDES</h3><ul><li class="navListItem"><a class="navItem" href="/docs/2.4.0/writing_contracts.html">Writing upgradeable contracts</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/publishing.html">Publishing an EVM package</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/testing.html">Testing upgradeable projects</a></li><li class="navListItem navListItemActive"><a class="navItem navItemActive" href="/docs/2.4.0/erc20_onboarding.html">Onboarding ERC20 tokens</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/upgrades_governance.html">Upgrades governance</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/zos_lib.html">Using the ZeppelinOS programmatic library</a></li></ul></div><div class="navGroup navGroupActive"><h3>ADVANCED TOPICS</h3><ul><li class="navListItem"><a class="navItem" href="/docs/2.4.0/faq.html">Frequently asked questions</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/configuration.html">Configuration Files</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/architecture.html">Contracts Architecture</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/pattern.html">ZeppelinOS Upgrades Pattern</a></li><li class="navListItem"><a class="navItem" href="/docs/2.4.0/whitepaper.html">Whitepaper</a></li></ul></div></div></section></div><script>
          var toggler = document.getElementById('navToggler');
          var nav = document.getElementById('docsNav');
          toggler.onclick = function() {
            nav.classList.toggle('docsSliderActive');
          };
        </script></nav></div><div class="container mainContainer"><div class="wrapper"><div class="post"><header class="postHeader"><h1>Onboarding ERC20 tokens</h1></header><article><div><span><h2><a class="anchor" aria-hidden="true" id="intro"></a><a href="#intro" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Intro</h2>
<p>This guide covers the migration of a regular ERC20 token to an upgradeable version of itself. During this process, the
original contract (to be called &quot;legacy&quot;) and the new contract, which will have the ability of being upgraded, will coexist.</p>
<p>The <em>new upgradable contract</em> will have the same functionality provided by the <em>legacy</em> contract, but it will be
<em>upgradable</em>. This means that we will be able to add new functionality, store new data, fix bugs or support new
standards as many times as we need, without any need to perform new migrations in the future.</p>
<h2><a class="anchor" aria-hidden="true" id="strategy"></a><a href="#strategy" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Strategy</h2>
<p>This strategy is based on an optional migration of the token balances. This migration is performed and paid by the
token holders. The new upgradeable token contract starts with no initial supply and no balances. The only way to &quot;mint&quot;
the new tokens is for users to &quot;turn in&quot; their old ones. This is done by first approving the amount they want to migrate,
and then calling a function of the upgradeable token to carry out the migration. The old tokens are sent to a burn
address, and the holder receives an equal amount in the new token contract.</p>
<h2><a class="anchor" aria-hidden="true" id="requirements"></a><a href="#requirements" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Requirements</h2>
<p>This on-boarding plan considers the following assumptions:</p>
<ul>
<li>There is an already deployed token contract that follows the ERC20 standard.</li>
<li>The legacy token contract is not frozen or paused, so token holders can trade it.</li>
</ul>
<h2><a class="anchor" aria-hidden="true" id="onboarding-plan-demo"></a><a href="#onboarding-plan-demo" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>Onboarding plan demo</h2>
<p>The central idea of this proposal is to deploy an upgradeable version of your token, using the ZeppelinOS command line
tool. Additionally, we will use the <a href="https://github.com/OpenZeppelin/openzeppelin-eth/blob/v2.0.0/contracts/drafts/ERC20Migrator.sol"><code>ERC20Migrator</code></a>
contract provided by <code>openzeppelin-eth</code>, the <a href="https://github.com/OpenZeppelin/openzeppelin-eth/">OpenZeppelin EVM package for ZeppelinOS</a>.</p>
<p>To better describe this plan we will use a sample project you can follow and clone from <a href="https://github.com/zeppelinos/erc20-onboarding/tree/zos-2.1">here</a>.</p>
<p>We will now setup a local environment to demo the onboarding plan. To do this, we will deploy a sample legacy token
contract and mint some balances. If you wish to work with your already deployed token, you can skip the following lines
and jump directly to the <a href="erc20_onboarding.html#1-initialize-your-migration-project-with-zeppelinos">step 1</a>.</p>
<p>In the sample repository you will find a contract called <a href="https://github.com/zeppelinos/erc20-onboarding/blob/master/contracts/MyLegacyToken.sol"><code>MyLegacyToken</code></a>
that we will use to simulate a real scenario locally. As you can see, this token will mint 100 tokens to the owner once
initialized just for testing purposes.</p>
<p><em>Before we begin, remember to install the dependencies running <code>npm install</code>. Additionally, you should check that everything
is working as expected by compiling the contracts with <code>npx truffle compile</code> and then running the test files with <code>npm test</code>.</em></p>
<p>Now, let's deploy the legacy token. We will use <a href="https://truffleframework.com/docs/ganache/quickstart">ganache-cli</a>, a
personal blockchain for Ethereum development that you can use to deploy your contracts and develop your applications.
To start using it, run the following command:</p>
<pre><code class="hljs css console">npx ganache-cli --port 9545
</code></pre>
<p>After that, you will be able to attach a truffle console to an already configured network inside the <code>truffle-config.js</code>
by running:</p>
<pre><code class="hljs css console">npx truffle console --network local
</code></pre>
<p>Then, run the following commands:</p>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> compile</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> owner = (await web3.eth.getAccounts())[1]</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> legacyToken = await MyLegacyToken.new({ from: owner })</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> legacyToken.address</span>
'0x...'
</code></pre>
<p>Keep track of the <code>owner</code> and <code>legacyToken</code> addresses, we will need them in the following steps.</p>
<p>You can check the owner balance by running:</p>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> (await legacyToken.balanceOf(owner)).toString()</span>
'10000000000000000000000'
</code></pre>
<p>Remember not to close this console, as we will be using it later.</p>
<h3><a class="anchor" aria-hidden="true" id="1-initialize-your-migration-project-with-zeppelinos"></a><a href="#1-initialize-your-migration-project-with-zeppelinos" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>1. Initialize your migration project with ZeppelinOS</h3>
<p>To initialize this project with ZeppelinOS, open a terminal and run the following line:</p>
<pre><code class="hljs css console">npx zos init my-token-migration 1.0.0
</code></pre>
<p>We have just initialized a new ZeppelinOS project. A new <code>zos.json</code> file should have been created.</p>
<p>Next, we will have to modify the legacy token contract to get the new upgradeable version of it where the current balances
are going to be migrated.</p>
<p>In our sample project, you will find another contract called <a href="https://github.com/zeppelinos/erc20-onboarding/blob/master/contracts/MyUpgradeableToken.sol"><code>MyUpgradeableToken</code></a>
which will be the upgradeable version of the sample legacy token contract <a href="https://github.com/zeppelinos/erc20-onboarding/blob/master/contracts/MyLegacyToken.sol"><code>MyLegacyToken</code></a>:</p>
<pre><code class="hljs css solidity">pragma solidity ^<span class="hljs-number">0.5</span>.<span class="hljs-number">0</span>;

<span class="hljs-keyword">import</span> <span class="hljs-string">"zos-lib/contracts/Initializable.sol"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"openzeppelin-eth/contracts/token/ERC20/IERC20.sol"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"openzeppelin-eth/contracts/drafts/ERC20Migrator.sol"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"openzeppelin-eth/contracts/token/ERC20/ERC20Mintable.sol"</span>;
<span class="hljs-keyword">import</span> <span class="hljs-string">"openzeppelin-eth/contracts/token/ERC20/ERC20Detailed.sol"</span>;

contract MyUpgradeableToken <span class="hljs-keyword">is</span> Initializable, ERC20, ERC20Detailed, ERC20Mintable {

  function initialize(ERC20Detailed _legacyToken, ERC20Migrator _migrator) initializer public {
    ERC20Mintable.initialize(address(_migrator));
    ERC20Detailed.initialize(_legacyToken.<span class="hljs-keyword">name</span>(), _legacyToken.<span class="hljs-keyword">symbol</span>(), _legacyToken.decimals());
    _migrator.beginMigration(this);
  }

}
</code></pre>
<p>On one hand, it is very important to replicate all the information and functionality that was provided by the
legacy token. In this case, we are inheriting from the <code>ERC20</code> and <code>ERC20Detailed</code> contracts provided by the
OpenZeppelin EVM package to replicate all the functionality of an ERC20 token.</p>
<p>On the other hand, we are defining an <code>initialize</code> method that receives an <code>ERC20Migrator</code> instance that will take care
of all the migration functionality we will need. To work with <code>ERC20Migrator</code>, your upgradeable token has to be
mintable, that's why we are also inheriting from the <code>ERC20Mintable</code> contract provided by the OpenZeppelin EVM
package as well.</p>
<p><em>Initializers are the way to define constructor functionality for upgradeable contracts in ZeppelinOS. The <code>initializer</code>
modifier will make sure your <code>initialize</code> method can only be called once in the whole lifetime of your contract.</em></p>
<p>Notice that all the contracts from <code>openzeppelin-eth</code> have been adapted for ZeppelinOS compatibility, and should be the
ones used when dealing with upgradeable contracts.</p>
<p>Besides allowing us to build upgradeable applications, ZeppelinOS provides EVM packages. To use an EVM package
in our project, we simply need to use the <code>link</code> command giving the name of the npm package of the EVM package we want
to use. In this case, we will link OpenZeppelin EVM package to be able to use the contracts it provides in our project:</p>
<pre><code class="hljs css console">npx zos link openzeppelin-eth
</code></pre>
<p>Finally we can add our upgradeable token contract to the project:</p>
<pre><code class="hljs css console">npx zos add MyUpgradeableToken
</code></pre>
<p>Great, our project has been linked to the OpenZeppelin EVM package and our <code>MyUpgradeableToken</code> has been added.</p>
<h3><a class="anchor" aria-hidden="true" id="2-deploy-the-upgradeable-token"></a><a href="#2-deploy-the-upgradeable-token" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>2. Deploy the upgradeable token</h3>
<p>The first thing we have to do is to deploy our contract source code. We will also need to deploy a copy of the
OpenZeppelin EVM package since we will be working on a local environment. To do so, run the following command:</p>
<pre><code class="hljs css console">npx zos push -n local --deploy-dependencies
</code></pre>
<p><em>Note that we are using the <code>--deploy-dependencies</code> to deploy the OpenZeppelin EVM package locally, since it is not
deployed in our local blockchain yet.</em></p>
<p>We have just deployed the <code>MyUpgradeableToken</code> source code and the OpenZeppelin EVM package to the <code>local</code> network. A
new <code>zos.dev-&lt;network_id&gt;.json</code> file should have been created.</p>
<p>Now, let's create a new instance of the upgradeable token using ZeppelinOS. To do so, we will need to create an
instance of an <code>ERC20Migrator</code> first, but given it is not yet provided by the OpenZeppelin EVM package, we will have
to add it manually. Then, run the following commands:
replacing <code>LEGACY_TOKEN_ADDRESS</code> with the address of the legacy token contract:</p>
<pre><code class="hljs css console">npx zos add ERC20Migrator
npx zos push -n local --deploy-dependencies
npx zos create ERC20Migrator --args LEGACY_TOKEN_ADDRESS -n local
</code></pre>
<p>Great! We have created a new upgradeable instance using the <code>ERC20Migrator</code> contract provided by the OpenZeppelin EVM
package. Now, we can create a new upgradeable instance of our <code>MyUpgradeableToken</code> running the following command. Please
make sure you replace <code>LEGACY_TOKEN_ADDRESS</code> with the address of the legacy token contract and <code>ERC20_MIGRATOR_ADDRESS</code>
with the address of the instance you created above:</p>
<pre><code class="hljs css console">npx zos create MyUpgradeableToken --args LEGACY_TOKEN_ADDRESS,ERC20_MIGRATOR_ADDRESS -n local
</code></pre>
<p>Save the upgradeable token address outputted by this command, we will need it later.</p>
<p>Note that the <code>proxies</code> section of <code>zos.dev-&lt;network_id&gt;.json</code> should now include the following, as ZeppelinOS is
tracking the upgradeable instances we have just created:</p>
<pre><code class="hljs css json">{
  ...,
  "proxies": {
    "erc20-onboarding/ERC20Migrator": [
      {
        "address": "0x...",
        "version": "1.0.0",
        "implementation": "0x..."
      }
    ],
    "erc20-onboarding/MyUpgradeableToken": [
      {
        "address": "0x...",
        "version": "1.0.0",
        "implementation": "0x..."
      }
    ]
  },
  ...
}
</code></pre>
<h3><a class="anchor" aria-hidden="true" id="3-migrate-your-old-token-balance"></a><a href="#3-migrate-your-old-token-balance" aria-hidden="true" class="hash-link"><svg class="hash-link-icon" aria-hidden="true" height="16" version="1.1" viewBox="0 0 16 16" width="16"><path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path></svg></a>3. Migrate your old token balance</h3>
<p>In order to migrate your balance, go back to the truffle console if you have deployed your legacy token locally
or open a new one against the network where your legacy token is deployed. Then, run the following commands, replacing
<code>ERC20_MIGRATOR_ADDRESS</code> and <code>UPGRADEABLE_TOKEN_ADDRESS</code> with their corresponding proxy address returned by <code>zos create</code>
commands of the previous step:</p>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> erc20Migrator = await ERC20Migrator.at(<span class="hljs-string">'ERC20_MIGRATOR_ADDRESS'</span>)</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> upgradeableToken = await MyUpgradeableToken.at(<span class="hljs-string">'UPGRADEABLE_TOKEN_ADDRESS'</span>)</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> erc20Migrator.beginMigration(upgradeableToken.address, { from: owner })</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> balance = await legacyToken.balanceOf(owner)</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> legacyToken.approve(erc20Migrator.address, balance, { from: owner })</span>
<span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> erc20Migrator.migrateAll(owner, { from: owner })</span>
</code></pre>
<p>We can now check your balance in the legacy token:</p>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> (await legacyToken.balanceOf(owner)).toString()</span>
'0'
</code></pre>
<p>Also the burned balance:</p>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> (await legacyToken.balanceOf(erc20Migrator.address)).toString()</span>
'10000000000000000000000'
</code></pre>
<p>And the upgradeable token balance:</p>
<pre><code class="hljs css console"><span class="hljs-meta">truffle(local)&gt;</span><span class="bash"> (await upgradeableToken.balanceOf(owner, { from: owner })).toString()</span>
'10000000000000000000000'
</code></pre>
<p>Your legacy token has been migrated to an upgradeable token!</p>
</span></div></article></div><div class="docs-prevnext"><a class="docs-prev button" href="testing.html">← Testing upgradeable projects</a><a class="docs-next button" href="upgrades_governance.html">Upgrades governance →</a></div></div></div></div><footer class="nav-footer" id="footer"><section class="sitemap"><a href="/" class="nav-home"><img src="/img/symbol-zeppelin.png" alt="ZeppelinOS" width="66" height="58"/></a><div><h5>Docs</h5><a href="/docs/start.html">Guides</a><a href="/docs/apis.html">Reference</a></div><div><h5>Community</h5><a href="https://forum.zeppelin.solutions/" target="_blank">Forum</a><a href="https://t.me/zeppelinos/" target="_blank">Telegram chat</a></div><div><h5>More</h5><a href="https://zeppelinos.org">Main Site</a><a href="https://blog.zeppelinos.org">Blog</a><a href="https://github.com/zeppelinos">GitHub</a></div></section><a href="https://zeppelinos.org" target="_blank" class="fbOpenSource"><img src="/img/logo.svg" alt="ZeppelinOS" width="170" height="45"/></a><section class="copyright">Copyright © 2017-present ZeppelinOS Global</section><section class="report-bugs"><a href="https://github.com/zeppelinos/zos/issues/new?labels=kind:documentation">Report a bug on this site</a></section></footer></div><script type="text/javascript" src="https://cdn.jsdelivr.net/docsearch.js/1/docsearch.min.js"></script><script>
              var search = docsearch({
                
                apiKey: '8d0b5afbba49947d9efb5659d1b08df7',
                indexName: 'zeppelinos',
                inputSelector: '#search_input_react',
                algoliaOptions: {}
              });
            </script></body></html>